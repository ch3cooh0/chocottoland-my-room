# ちょこころね

## 概要
ちょこころねは、装備の組み合わせを最適化するためのツールです。特定のステータスを最大化するための装備の組み合わせを探索し、冒険者さんのステータスを最大化することができます。

## 使い方

1. **装備の登録（倉庫）**:
   - 保有している装備を部位ごとに登録します。
   - 強化値、特殊コアも登録できます。

2. **装備の検索**:
   - 装備名称やステータスから装備を検索できます。

3. **装備の保存と読み込み**:
   - 倉庫の内容や冒険者さんのステータスをファイルに保存し、後で読み込むことができます。
   - マネキン(装備の組合せ)も保存できます。

4. **装備の組み合わせ生成**:
   - 指定されたステータスが最大になる装備の組み合わせを探索します。
   - 単一ステータスが最大になる組み合わせの探索にのみ対応しています。

## 計算の仕様

1. **装備ステータスの合計**:
   - メイン装備とサブ装備のステータスを合計します。
   - メイン装備の合計値の計算
     - 装備の純粋な合計値+錬成強化値+特殊コアの合計値
   - サブ装備の合計値の計算
     - （装備+錬成強化値）* 0.5（少数切り上げ）の合計値

2. **セット効果の適用**:
   - 特定の装備の組み合わせによるセット効果が適用されます。
   - メイン装備の組み合わせによるセット効果のみ対応しています。

3. **装備効果の適用**:
   - 装備ごとの特殊効果がステータスに反映されます。
   - メイン装備の装備効果のみ対応しています。

4. **最終ステータスの計算**:
   - 冒険者さんの基本ステータス、アバターステータス、装備ステータス、セット効果、装備効果を全て合計して最終的なステータスを算出します。


## 組合せ探索の仕様

倉庫に登録された装備の中から、指定されたステータスが最大になる組み合わせを探索します。

### 探索アルゴリズム(単一ステータス)

#### １．対象装備の絞り込み

以下の装備を探索対象とします。

- メイン装備
   - 対象ステータスが最大の装備
     - 錬成強化を含む
     - 特殊コアを含む
     - ATK,DEF,MAT,MDFはpow,int,vit,による増加も含む
   - 装備効果（アバティアなど）で対象ステータスが増加する装備
   - セット効果で対象ステータスが増加する装備
- サブ装備
   - 対象ステータス上位２件の装備


#### ２．探索

探索対象の装備の組み合わせを全て試し、対象ステータスが最大になる組み合わせを返します。
セット効果、装備効果をもつ装備を多数保有している場合は、探索時間が長くなります。

### 探索アルゴリズム(複数ステータス)

まだ実装されていません。
pow,int,vit,spd,lukのうち２つを選択し、重みを指定してその合計値が最大になる組み合わせを探索します。

ちょこころねを使って、最適な装備の組み合わせを見つけ、冒険に備えましょう！

## ユーザーデータについて

倉庫の内容、冒険者さんのステータス、アバター、マネキンの組み合わせはファイルに保存できます。
ファイルフォーマットはJsonです。
拡張子をそれぞれ以下のようにして保存されます。

- 倉庫の内容: .wherehouse.json
- 冒険者さんのステータス: .character.json
- アバター: .avatar.json
- マネキンの組み合わせ: .mannequin.json

## マスターデータについて

dataフォルダには、マスターデータが入っています。

### 装備

equipments.csvには、装備のマスターデータが入っています。
- id: 装備ID(セット効果、装備効果の判定に使用)

### 装備効果マスターデータ

equipment_effects.csvには、装備効果のマスターデータが入っています。
- ability_id: 装備効果ID
- ability_type: 装備効果の種類
   - pet_base_status: ペットに関する効果
   - player_base_status: 冒険者さんのステータス効果
   - player_ability: 特殊効果
- equipment_id: 装備ID
- source_status: 効果の基準となるステータス
- target_status: 発動効果のステータス
- effect: 発動効果
- text: 装備効果の説明

### セット効果マスターデータ（データ構造の正規化が十分ではない）

combo_equipments.csv,combo_statuses.csvには、セット効果のマスターデータが入っています。
- combo_equipments.csv: セット効果の発動条件装備を定義
   - "combo_id": セット効果ID
   - "part": 部位
   - "equipment_id": 装備ID
   - "count": 発動に必要な最低装備数
   - "need": 必須装備(0: 必須ではない, 1: 必須)
- combo_statuses.csv: セット効果のステータスを定義
   - "combo_id": セット効果ID
   - "group_id": グループID。同じグループIDのセット効果は同時に発動しない。
   - "text": セット効果の説明（何が発動しているかわかるように適当な名称をつける）

## その他

- マネキンの組み合わせを保存する場合は、マネキンの装備を全て倉庫に登録してください。
- マネキンの組み合わせを読み込む場合は、マネキンの装備を全て倉庫に登録してください。
- マネキンの組み合わせを保存したファイルを読み込む場合は、マネキンの装備を全て倉庫に登録してください。
